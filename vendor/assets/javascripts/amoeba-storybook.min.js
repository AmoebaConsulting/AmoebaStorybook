/*! amoeba-storybook - v0.1.1 - 2013-02-24
* Copyright (c) 2013 ; Licensed  */
(function(){var e;(e=window.AmoebaSB)==null&&(window.AmoebaSB={}),jQuery(function(e){return AmoebaSB.eventHelper=new AmoebaSB.EventHelper})}).call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};AmoebaSB.KeyframeAnimationPlugin=function(){function e(){this.animationCallback=t(this.animationCallback,this),this._setupJQueryFunctions=t(this._setupJQueryFunctions,this);var e,n,r,i;AmoebaSB.keyframeAnimationPlugin!=null&&console.log("AmoebaSB.keyframeAnimationPlugin created twice?"),i={animation:["animation","animationend","keyframes"],webkitAnimation:["-webkit-animation","webkitAnimationEnd","-webkit-keyframes"],MozAnimation:["-moz-animation","animationend","-moz-keyframes"],OAnimation:["-o-animation","oAnimationEnd","-o-keyframes"],MSAnimation:["-ms-animation","MSAnimationEnd","-ms-keyframes"]},r=document.createElement("div").style;for(e in i)if(r[e]!==void 0){n=i[e],this.animationProperty=n[0],this.endAnimation=n[1],this.keyFramesProperty=n[2];break}this._setupJQueryFunctions()}return e.prototype._setupJQueryFunctions=function(){return $.fn.keyframe=function(e,t,n,r,i,s,o){var u;return typeof t=="object"&&(o=t.complete,s=t.direction,i=t.iterations,r=t.delay,n=t.easing,t=t.duration),s=s||"normal",i=i||1,r=r||0,n=n||"linear",t=t||1,typeof t=="number"&&(t+="ms"),typeof r=="number"&&(r+="ms"),o&&AmoebaSB.keyframeAnimationPlugin.animationCallback(this,o),u=[e,t,n,r,i,s,"forwards"].join(" "),this.css(AmoebaSB.keyframeAnimationPlugin.animationProperty,u)},this},e.prototype.animationCallback=function(e,t){return e.one(this.endAnimation,e,t)},e}(),(e=AmoebaSB.keyframeAnimationPlugin)==null&&(AmoebaSB.keyframeAnimationPlugin=new AmoebaSB.KeyframeAnimationPlugin)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};AmoebaSB.EventHelper=function(){function t(){this._handleKeyEvent=e(this._handleKeyEvent,this),this._setupKeyHandler=e(this._setupKeyHandler,this),this.triggerEvent=e(this.triggerEvent,this),this._setupKeyHandler(),this.nextKeyEventName="next:keyEvent",this.prevKeyEventName="prev:keyEvent",this.resizeEventName="resize:windowEvent"}return t.prototype.triggerEvent=function(e,t,n){var r;return r=document.createEvent("CustomEvent"),r.initCustomEvent(t,!0,!0,n),e.dispatchEvent(r)},t.prototype._setupKeyHandler=function(){var e=this;return document.addEventListener("keydown",function(t){return e._handleKeyEvent(t)}),document.addEventListener("keyup",function(t){return e._handleKeyEvent(t)}),document.addEventListener("touchstart",function(t){var n,r;if(t.touches.length===1){r=t.touches[0].clientX,n=window.innerWidth*.3;if(r<n)return e.triggerEvent(document,e.prevKeyEventName),t.preventDefault();if(r>window.innerWidth-n)return e.triggerEvent(document,e.nextKeyEventName),t.preventDefault()}}),window.addEventListener("resize",function(t){if(!e.sentReizeEvent)return e.sentResizeEvent=!0,setTimeout(function(){return e.triggerEvent(document,e.resizeEventName),e.sentResizeEvent=!1},250)})},t.prototype._handleKeyEvent=function(e){var t,n,r,i,s,o,u;o=9,s=32,n=37,u=38,r=39,t=40,i=!1,e.type==="keyup"&&(i=!0);switch(e.keyCode){case o:case t:case r:case s:e.preventDefault();if(i)return this.triggerEvent(document,this.nextKeyEventName);break;case n:case u:e.preventDefault();if(i)return this.triggerEvent(document,this.prevKeyEventName)}},t}()}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};AmoebaSB.GraphicsPaper=function(){function t(t,n){this.divHolder=t,this._fadePoint=e(this._fadePoint,this),this.clearPoints=e(this.clearPoints,this),this.clearAll=e(this.clearAll,this),this.pulsatePoints=e(this.pulsatePoints,this),n==null&&(n={fill:"90-#aaf-#004",stroke:"#f99"}),this.paper=Raphael(this.divHolder),this.paper.rect(0,0,this.width(),this.height()).attr(n),this.points=[]}return t.prototype.width=function(){return this.paper.canvas.clientWidth?this.paper.canvas.clientWidth:this.paper.width},t.prototype.height=function(){return this.paper.canvas.clientHeight?this.paper.canvas.clientHeight:this.paper.height},t.prototype.addPoints=function(e,t,n){var r=this;return n==null&&(n="#f00"),_.each(e,function(e){var i;return i=r.paper.circle(e.x,e.y,t),i.attr({fill:n,stroke:"none"}),r.points.push(i)})},t.prototype.pulsatePoints=function(){var e=this;return _.each(this.points,function(t){return e._fadePoint(!0,t)})},t.prototype.clearAll=function(){return this.paper.clear()},t.prototype.clearPoints=function(){var e=this;return _.each(this.points,function(e){return e.remove()})},t.prototype._fadePoint=function(e,t){var n,r,i=this;return r=Raphael.animation({transform:"s2",opacity:1},600,"<",function(){return i._fadePoint(!e,t)}),n=Raphael.animation({transform:"s1",opacity:.1},600,">",function(){return i._fadePoint(!e,t)}),t.stop(),e?t.animate(r):t.animate(n)},t}(),AmoebaSB.Point=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.toString=function(){return"("+this.x+", "+this.y+")"},e.prototype.distance=function(e){var t,n;return t=e.x-this.x,t*=t,n=e.y-this.y,n*=n,Math.sqrt(t+n)},e}(),AmoebaSB.Pair=function(){function e(e,t){this.left=e,this.right=t}return e.prototype.toString=function(){return"("+this.left+", "+this.right+")"},e}(),AmoebaSB.Rect=function(){function e(e,t,n,r){this.x=e,this.y=t,this.w=n,this.h=r}return e.prototype.toString=function(){return"(x:"+this.x+", y:"+this.y+", w:"+this.w+", h:"+this.h+")"},e}(),AmoebaSB.Graphics=function(){function e(){}return e.toDegrees=function(e){return e*(180/Math.PI)},e.toRadians=function(e){return e*(Math.PI/180)},e.pointForAngle=function(e,t,n){var r,i;return r=Math.cos(AmoebaSB.Graphics.toRadians(e)),i=Math.sin(AmoebaSB.Graphics.toRadians(e)),new AmoebaSB.Point(n.x+r*t,n.y+i*t)},e.normalizePath=function(e){var t,n,r;return t=Raphael.pathBBox(e),n=new Raphael.matrix,n.translate(-t.x,-t.y),r=n.toTransformString(),e=Raphael.transformPath(e,r),e},e.scalePath=function(e,t,n){var r,i;return r=new Raphael.matrix,r.scale(t,n),i=r.toTransformString(),e=Raphael.transformPath(e,i),e},e.translatePath=function(e,t,n){var r,i;return r=new Raphael.matrix,r.translate(t,n),i=r.toTransformString(),e=Raphael.transformPath(e,i),e},e.rotatePath=function(e,t){var n,r,i;return n=Raphael.pathBBox(e),r=new Raphael.matrix,r.rotate(t,n.x+n.width/2,n.y+n.height/2),i=r.toTransformString(),e=Raphael.transformPath(e,i),e},e.circleWithFourPoints=function(e,t,n){var r,i,s=this;return r=new AmoebaSB.Point(e,t),i=void 0,_.each([0,90,180,270,360],function(o){var u;return u=s.pointForAngle(o,n,r),i!=null?i+="A"+n+","+n+",0,0,1,"+u.x+","+u.y:i="M"+(e+n)+", "+t}),i!=null&&(i+="z",i=this.rotatePath(i,-135)),i},e.rectWithFourPoints=function(e,t,n,r){var i;return i="M"+e+", "+t,i+="l"+n+", 0",i+="l0, "+r,i+="l"+ -n+", 0",i+="l0, "+ -r,i},e.trianglePath=function(e,t,n,r,i,s){var o;return o="M"+e+","+t,o+="L"+n+","+r,o+="L"+i+","+s,o},e}()}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};AmoebaSB.NavigationControls=function(){function t(t){var n=this;this.numSteps=t,this._setupNextPrevButtons=e(this._setupNextPrevButtons,this),this._setupRadioButtons=e(this._setupRadioButtons,this),this.cssID="navigationControls",this.el=$("#"+this.cssID),this._setupRadioButtons(),this._setupNextPrevButtons(),document.addEventListener("slideTransitions:in",function(e){var t,r;return r=Number(e.detail),$("input:radio[name=presentationRadioGroup]:nth("+r+")").attr("checked",!0),t=r/(n.numSteps-1),$("#progressBar span").css({width:""+t*window.innerWidth+"px"})}),$("<div/>").appendTo(this.el).attr({id:"progressBar"}).html("<span></span>").click(function(e){var t;return t=Math.floor(e.clientX/n.el.get(0).offsetWidth*n.numSteps),AmoebaSB.eventHelper.triggerEvent(document,"navigateToIndexEventName",t)})}return t.prototype._setupRadioButtons=function(){var e,t,n,r,i,s=this;return e=$("<div/>").css({bottom:"0px",margin:"0 auto",bottom:0,"float":"left",left:"50%",position:"absolute"}).appendTo(this.el),t=$("<span/>").css({"float":"left",position:"relative",right:"50%"}).appendTo(e),_.each(function(){i=[];for(var e=0,t=this.numSteps;0<=t?e<t:e>t;0<=t?e++:e--)i.push(e);return i}.apply(this),function(e,n){var r;r=$("<input/>").attr({type:"radio",name:"presentationRadioGroup",value:e}).appendTo(t);if(e===0)return r.attr({checked:""})}),$("input[name=presentationRadioGroup]:radio").change(function(){var e;return e=$(this).val(),AmoebaSB.eventHelper.triggerEvent(document,"navigateToIndexEventName",e)})},t.prototype._setupNextPrevButtons=function(){var e,t=this;return e=$("<a/>").attr({id:"nextButton"}).appendTo(this.el),e.click(function(e){return AmoebaSB.eventHelper.triggerEvent(document,AmoebaSB.eventHelper.nextKeyEventName)}),e=$("<a/>").attr({id:"prevButton"}).appendTo(this.el),e.click(function(e){return AmoebaSB.eventHelper.triggerEvent(document,AmoebaSB.eventHelper.prevKeyEventName)})},t}()}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};AmoebaSB.Slide_Base=function(){function t(){this._setupElement=e(this._setupElement,this),this._update=e(this._update,this),this.slideIn=e(this.slideIn,this),this.slideOut=e(this.slideOut,this),this.slideInEvent=e(this.slideInEvent,this),this.slideOutEvent=e(this.slideOutEvent,this),this.next=e(this.next,this),this.stepIndex=0,this.previousStepIndex=0,this.numSteps=0,this.cssID="????",this.transition="fade",this.setup()}return t.prototype.setup=function(){return console.log("must subclass and implement setup")},t.prototype.next=function(){return this.stepIndex<this.numSteps-1?(this.stepIndex++,this._update(),!0):!1},t.prototype.slideOutEvent=function(e){return this.activeSlide=!1,this.slideOut(e)},t.prototype.slideInEvent=function(e){return this.activeSlide=!0,this.slideIn(e)},t.prototype.slideOut=function(e){},t.prototype.slideIn=function(e){},t.prototype._update=function(){return console.log("must subclass and implement _update")},t.prototype._setupElement=function(e){return this.cssID=e,this.el=$("#"+this.cssID),AmoebaSB.layout.setupSlide(this.el)},t}()}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};AmoebaSB.SlideLayout=function(){function t(t,n){var r=this;this.$stage=t,this.$stageHolder=n,this._adjustStage=e(this._adjustStage,this),this._setupStage=e(this._setupStage,this),this._computeWindowScale=e(this._computeWindowScale,this),this.setupSlide=e(this.setupSlide,this),this.normal=e(this.normal,this),this.horizOffscreen=e(this.horizOffscreen,this),this.vertOffscreen=e(this.vertOffscreen,this),this.center=e(this.center,this),this.slideInset=10,this.slideWidth=940,this.slideHeight=700,this.stageWidth=this.slideWidth+this.slideInset,this.stageHeight=this.slideHeight+this.slideInset,document.addEventListener(AmoebaSB.eventHelper.resizeEventName,function(e){return r._adjustStage()}),this._setupStage(this.$stage),this._adjustStage()}return t.prototype.center=function(e,t,n){var r;return r={left:(this.slideWidth-e)/2,top:(this.slideHeight-t)/2,x:0,y:0},n!=null&&(r=_.extend(r,n)),r},t.prototype.vertOffscreen=function(e,t){var n;return e==null&&(e=!0),n={y:e?-window.innerHeight:window.innerHeight},t!=null&&(n=_.extend(n,t)),n},t.prototype.horizOffscreen=function(e,t){var n;return e==null&&(e=!0),t==null&&(t=void 0),n={x:e?-window.innerWidth:window.innerWidth},t!=null&&(n=_.extend(n,t)),n},t.prototype.normal=function(e){var t;return e==null&&(e=1),t={y:0,x:0,rotate:0,rotateY:0,skewX:0,skewY:0,rotateX:0,scale:1,opacity:e,transformOrigin:"50% 50%",display:"block"},t},t.prototype.setupSlide=function(e){return e.css({position:"absolute",opacity:0,display:"none",width:this.slideWidth,height:this.slideHeight})},t.prototype._computeWindowScale=function(){var e,t,n;return e=window.innerHeight/this.stageHeight,n=window.innerWidth/this.stageWidth,e>n?t=n:t=e,t<0&&(t=0),t},t.prototype._setupStage=function(e){return e.css({top:0,left:0,position:"absolute",height:this.slideHeight,width:this.slideWidth,x:"-50%",y:"-50%",opacity:1,transformOrigin:"50% 50%"})},t.prototype._adjustStage=function(){var e=this;return this.internalScaleMethod==null&&(this.$stageHolder.css({position:"absolute",top:"50%",left:"50%",transformOrigin:"top left",height:"100%",width:"100%"}),this.internalScaleMethod=_.throttle(function(){var t;return t=e._computeWindowScale(),e.$stageHolder.transition({scale:t},100)},500)),this.internalScaleMethod()},t}()}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};AmoebaSB.SlideTransitions=function(){function n(t){this.slides=t,this._rotateTransitionSpec=e(this._rotateTransitionSpec,this),this._zoomTransitionSpec=e(this._zoomTransitionSpec,this),this._warpTransitionSpec=e(this._warpTransitionSpec,this),this._fadeTransitionSpec=e(this._fadeTransitionSpec,this),this._dropTransitionSpec=e(this._dropTransitionSpec,this),this._slideTransitionSpec=e(this._slideTransitionSpec,this),this._transitionSpec=e(this._transitionSpec,this),this._sendEvents=e(this._sendEvents,this),this._slideAtIndex=e(this._slideAtIndex,this),this._nextStepIndex=e(this._nextStepIndex,this),this._validStepIndex=e(this._validStepIndex,this),this.goto=e(this.goto,this),this.prevIndex=e(this.prevIndex,this),this.nextIndex=e(this.nextIndex,this),this.duration=1e3}var t;return n.prototype.nextIndex=function(){return this._nextStepIndex(!0)},n.prototype.prevIndex=function(){return this._nextStepIndex(!1)},n.prototype.goto=function(e){var t,n,r,i,s=this;e=this._validStepIndex(e),this.activeStepIndex!=null&&(n=e<this.activeStepIndex);if(e!==this.activeStepIndex)return this.activeStepIndex!=null&&(t=this._slideAtIndex(this.activeStepIndex)),this.activeStepIndex=e,r=this._slideAtIndex(this.activeStepIndex),i=function(){return s._sendEvents(t,r,!0)},r!=null&&t!=null?n?this._transitionSpec("previous").run(t,r,i):this._transitionSpec(r.transition).run(t,r,i):(r.el.css(AmoebaSB.layout.normal()),i()),this._sendEvents(t,r,!1)},n.prototype._validStepIndex=function(e){return e<0?e=0:e>=this.slides.length&&(e=this.slides.length-1),e},n.prototype._nextStepIndex=function(e){var t;return t=this.activeStepIndex,t!==-1&&(e?t+=1:t-=1),this._validStepIndex(t)},n.prototype._slideAtIndex=function(e){return e=this._validStepIndex(e),this.slides[e]},n.prototype._sendEvents=function(e,t,n){e!=null&&(e.slideOutEvent(n),n||AmoebaSB.eventHelper.triggerEvent(e.el.get(0),"slideTransitions:out",this.slides.indexOf(e)));if(t!=null){t.slideInEvent(n);if(!n)return AmoebaSB.eventHelper.triggerEvent(t.el.get(0),"slideTransitions:in",this.slides.indexOf(t))}},n.prototype._transitionSpec=function(e){var t;switch(e){case"zoom":t=this._zoomTransitionSpec();break;case"next":t=this._slideTransitionSpec(!1);break;case"previous":t=this._slideTransitionSpec(!0);break;case"down":t=this._dropTransitionSpec(!1);break;case"up":t=this._dropTransitionSpec(!0);break;case"fade":t=this._fadeTransitionSpec();break;case"warp":t=this._warpTransitionSpec();break;case"rotate":t=this._rotateTransitionSpec();break;default:console.log("not found: "+e)}return t},n.prototype._slideTransitionSpec=function(e){var n;return e==null&&(e=!1),n=new t(AmoebaSB.layout.horizOffscreen(e)),n.addActive(AmoebaSB.layout.horizOffscreen(!e,{opacity:0})),n.finalize({duration:this.duration}),n},n.prototype._dropTransitionSpec=function(e){var n;return e==null&&(e=!0),n=new t(AmoebaSB.layout.vertOffscreen(e)),n.addActive(AmoebaSB.layout.vertOffscreen(!e,{opacity:0})),n.finalize({duration:this.duration}),n},n.prototype._fadeTransitionSpec=function(){var e;return e=new t({opacity:0}),e.addActive({opacity:0}),e.finalize({duration:this.duration}),e},n.prototype._warpTransitionSpec=function(){var e,n;return n=window.innerWidth,e=new t({scale:.4,x:-n}),e.addActive({opacity:.8,scale:.4}),e.addActive({opacity:0,skewX:80,x:n}),e.addNext({opacity:1,x:0,delay:this.duration/2}),e.finalize({duration:this.duration}),e},n.prototype._zoomTransitionSpec=function(){var e;return e=new t({opacity:0,scale:0,rotate:60}),e.addActive({opacity:.5,scale:1.5,easing:"out",duration:this.duration*.2}),e.addActive({opacity:0,scale:0,easing:"ease",duration:this.duration*.8}),e.finalize({delay:300,duration:this.duration}),e},n.prototype._rotateTransitionSpec=function(){var e;return e=new t({opacity:0,rotate:-180}),e.addActive({opacity:0,rotate:180}),e.setTransformOrigin("50% 100%"),e.finalize({duration:this.duration}),e},t=function(){function t(t){this.nextSlideState=t,this.finalize=e(this.finalize,this),this.setTransformOrigin=e(this.setTransformOrigin,this),this.run=e(this.run,this),this._nextArray=[],this._activeArray=[]}return t.prototype.run=function(e,t,n){var r=this;return e!=null&&t!=null?(this.completeCallback=n,t.el.css($.extend(AmoebaSB.layout.normal(0),this.nextSlideState)),this.transformOrigin!=null&&(e.el.css({transformOrigin:this.transformOrigin}),t.el.css({transformOrigin:this.transformOrigin})),_.each(this._activeArray,function(t,n){return e.el.transition(t)}),_.each(this._nextArray,function(e,n){return t.el.transition(e)})):console.log("SlideTransition run: bad parameter")},t.prototype.addNext=function(e){return this._nextArray.push(e)},t.prototype.addActive=function(e){return this._activeArray.push(e)},t.prototype.setTransformOrigin=function(e){return this.transformOrigin=e},t.prototype.finalize=function(e){var t,n,r=this;return n=AmoebaSB.layout.normal(),e!=null&&(n=$.extend(n,e)),t=function(){if(r.completeCallback!=null)return r.completeCallback()},n=$.extend(n,{complete:t}),this._nextArray.push(n),this._activeArray.push({display:"none"})},t}(),n}.call(this)}.call(this),function(){}.call(this);